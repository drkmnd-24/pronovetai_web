{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>PronoveTAI • Building List</title>

  <link rel="shortcut icon" href="{% static '/assets/compiled/svg/favicon.svg' %}" type="image/x-icon">
  <link rel="stylesheet" href="{% static 'assets/extensions/datatables.net-bs5/css/dataTables.bootstrap5.min.css' %}">
  <link rel="stylesheet" href="{% static '/assets/compiled/css/table-datatable-jquery.css' %}">
  <link rel="stylesheet" href="{% static '/assets/compiled/css/app.css' %}">
  <link rel="stylesheet" href="{% static '/assets/compiled/css/app-dark.css' %}">
</head>
<body>
<script src="{% static 'assets/static/js/initTheme.js' %}"></script>
{% include '_sidebar.html' with active='building_list' %}

<div id="app">
  <div id="main">
    <header class="mb-3">
      <a class="burger-btn d-block d-xl-none" href="#"><i class="bi bi-justify fs-3"></i></a>
    </header>

    <div class="page-heading">
      <div class="page-title">
        <div class="row">
          <div class="col-12 col-md-6 order-md-1 order-last">
            <h3>Building List</h3>
            <p class="text-subtitle text-muted">Interactive Datatable with CRUD, image upload, and logs</p>
          </div>
          <div class="col-12 col-md-6 order-md-2 order-first">
            <nav aria-label="breadcrumb" class="breadcrumb-header float-start float-lg-end">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'dashboard_page' %}">Dashboard</a></li>
                <li class="breadcrumb-item active" aria-current="page">Building List</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>

      <section class="section">
        <div class="card">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <button id="btn-add-building" class="btn btn-primary">
                  <i class="bi bi-plus-lg me-1"></i> Add Building
                </button>
              </div>
              <div class="text-muted small">Tip: click “Logs” on any row to see & add notes.</div>
            </div>

            <div class="table-responsive">
              <table class="table table-striped" id="buildings-table" style="width:100%">
                <thead>
                <tr>
                  <th>Name</th>
                  <th>Grade</th>
                  <th>PEZA</th>
                  <th>Strata</th>
                  <th>City</th>
                  <th>Last Update</th>
                  <th>By</th>
                  <th class="text-center">Actions</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </div>

    {% include '_footer.html' %}
  </div>
</div>

<!-- Create/Edit Building Modal -->
<div class="modal fade" id="buildingModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="buildingModalTitle" class="modal-title">Add Building</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="buildingForm" class="row g-3" enctype="multipart/form-data">
          <input type="hidden" id="building_id">
          <div class="col-md-6">
            <label class="form-label">Name</label>
            <input id="b_name" class="form-control" required>
          </div>
          <div class="col-md-3">
            <label class="form-label">Grade (code)</label>
            <input id="b_grade" class="form-control" placeholder="e.g. A / B / SPA">
          </div>
          <div class="col-md-3">
            <label class="form-label">Type (ID)</label>
            <input id="b_type" class="form-control" placeholder="BuildingType id">
          </div>

          <div class="col-md-4">
            <label class="form-label">City</label>
            <input id="b_city" class="form-control">
          </div>
          <div class="col-md-4 d-flex align-items-end">
            <div class="form-check me-4">
              <input id="b_peza" type="checkbox" class="form-check-input">
              <label class="form-check-label" for="b_peza">PEZA</label>
            </div>
            <div class="form-check">
              <input id="b_strata" type="checkbox" class="form-check-input">
              <label class="form-check-label" for="b_strata">Strata</label>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label">Upload Image (optional)</label>
            <input id="b_image" type="file" class="form-control" accept="image/*">
          </div>

          <div class="col-12">
            <label class="form-label">Log note (optional)</label>
            <textarea id="b_log" class="form-control" rows="2" placeholder="What changed?"></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-light-secondary" data-bs-dismiss="modal">Close</button>
        <button id="saveBuildingBtn" class="btn btn-primary">Save</button>
      </div>
    </div>
  </div>
</div>

<!-- Logs Modal -->
<div class="modal fade" id="logsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Building Logs</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul id="logsList" class="list-group small mb-3"></ul>
        <div class="input-group">
          <textarea id="logMessage" class="form-control" rows="2" placeholder="Add a note…"></textarea>
          <button id="addLogBtn" class="btn btn-primary">Add</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="{% static '/assets/static/js/components/dark.js' %}"></script>
<script src="{% static '/assets/extensions/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
<script src="{% static '/assets/compiled/js/app.js' %}"></script>

<script src="{% static '/assets/extensions/jquery/jquery.min.js' %}"></script>
<script src="{% static '/assets/extensions/datatables.net/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static '/assets/extensions/datatables.net-bs5/js/dataTables.bootstrap5.min.js' %}"></script>
<script src="{% static '/assets/static/js/pages/datatables.js' %}"></script>

<script src="{% static 'js_function/building_list.js' %}"></script>